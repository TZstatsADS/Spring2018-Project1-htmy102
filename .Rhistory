speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 2), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,4,8,9,10)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 2), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 2), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,8,9,12)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 2), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1:15)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
View(inaug.list)
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 3), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1:15)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==middle_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=middle_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 3), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,8,9,12)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==middle_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=middle_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 3), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,4,5,8,9,10,11,12,15)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==middle_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=middle_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 3), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,4,5,8,9,10,11,12,15)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==middle_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=middle_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
# [1] "Military"  "WorldPeace"  "Time"  "Economy",
# [5] "Nation"  "Responsibility"  "Hope"  "Equality",
# [9] "America"  "Politic"  "WorkingFamilies"  "Legislation",
# [13] "Community"  "Government"  "Patriotism"
par(mfcol=c(5, 3), mar=c(1,1,2,0), bty="n", xaxt="n", yaxt="n")
topic.plot=c(1,2,4,5,8,9,10,11,12,15)
print(topics.hash[topic.plot])
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==recent_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=recent_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==middle_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=middle_presidents[i])
}
for(i in 5:1){
speech.df=tbl_df(corpus.list.df)%>%filter(File==founding_presidents[i],  Term==1)%>%
select(sent.id, Military:Patriotism)
speech.df=as.matrix(speech.df)
speech.df[,-1]=replace(speech.df[,-1], speech.df[,-1]<1/15, 0.001)
speech.df[,-1]=f.smooth.topic(x=speech.df[,1], y=speech.df[,-1])
plot.stacked(speech.df[,1], speech.df[,topic.plot+1],
xlab="Sentences", ylab="Topic share", main=founding_presidents[i])
}
par(mfrow=c(1,2), mar=c(1,0,2,0), bty="n", xaxt="n", yaxt="n", font.main=1)
folder.path="../data/inauguralSpeeches/"
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
recent_locale <- paste(folder.path,"inaug",recent_presidents,"-1.txt",sep = "")
middle_locale <- paste(folder.path,"inaug",middle_presidents,"-1.txt",sep = "")
founding_locale <- paste(folder.path,"inaug",founding_presidents,"-1.txt",sep = "")
speechesCloud(recent_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(middle_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(founding_locale,150,color=brewer.pal(9,"Blues"))
par(mfrow=c(1,3), mar=c(1,0,2,0), bty="n", xaxt="n", yaxt="n", font.main=1)
folder.path="../data/inauguralSpeeches/"
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
recent_locale <- paste(folder.path,"inaug",recent_presidents,"-1.txt",sep = "")
middle_locale <- paste(folder.path,"inaug",middle_presidents,"-1.txt",sep = "")
founding_locale <- paste(folder.path,"inaug",founding_presidents,"-1.txt",sep = "")
speechesCloud(recent_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(middle_locale,150,color=brewer.pal(9,"Greens"))
speechesCloud(founding_locale,150,color=brewer.pal(9,"Blues"))
par(mfrow=c(1,3), mar=c(0,0,0,0), bty="n", xaxt="n", yaxt="n", font.main=1)
folder.path="../data/inauguralSpeeches/"
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
recent_locale <- paste(folder.path,"inaug",recent_presidents,"-1.txt",sep = "")
middle_locale <- paste(folder.path,"inaug",middle_presidents,"-1.txt",sep = "")
founding_locale <- paste(folder.path,"inaug",founding_presidents,"-1.txt",sep = "")
speechesCloud(recent_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(middle_locale,150,color=brewer.pal(9,"Greens"))
speechesCloud(founding_locale,150,color=brewer.pal(9,"Blues"))
par(mfrow=c(1,3), mar=c(0,0,0,0), bty="n", xaxt="n", yaxt="n", font.main=1)
folder.path="../data/inauguralSpeeches/"
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
recent_locale <- paste(folder.path,"inaug",recent_presidents,"-1.txt",sep = "")
middle_locale <- paste(folder.path,"inaug",middle_presidents,"-1.txt",sep = "")
founding_locale <- paste(folder.path,"inaug",founding_presidents,"-1.txt",sep = "")
speechesCloud(recent_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(middle_locale,150,color=brewer.pal(9,"Greens"))
speechesCloud(founding_locale,150,color=brewer.pal(9,"Blues"))
setwd("~/Documents/GitHub/Spring2018-Project1-htmy102")
par(mfrow=c(1,3), mar=c(0,0,0,0), bty="n", xaxt="n", yaxt="n", font.main=1)
folder.path="../data/inauguralSpeeches/"
recent_presidents <- c("GeorgeBush","WilliamJClinton","GeorgeWBush","BarackObama","DonaldJTrump")
middle_presidents <- c("BenjaminHarrison","GroverCleveland-I","WilliamMcKinley",
"TheodoreRoosevelt","WilliamHowardTaft")
founding_presidents <- c("GeorgeWashington","JohnAdams","ThomasJefferson","JamesMadison","JamesMonroe")
recent_locale <- paste(folder.path,"inaug",recent_presidents,"-1.txt",sep = "")
middle_locale <- paste(folder.path,"inaug",middle_presidents,"-1.txt",sep = "")
founding_locale <- paste(folder.path,"inaug",founding_presidents,"-1.txt",sep = "")
speechesCloud(recent_locale,150,color=brewer.pal(9,"Reds"))
speechesCloud(middle_locale,150,color=brewer.pal(9,"Greens"))
speechesCloud(founding_locale,150,color=brewer.pal(9,"Blues"))
packages.used=c("rvest", "tibble", "qdap",
"sentimentr", "gplots", "dplyr",
"tm", "syuzhet", "factoextra",
"beeswarm", "scales", "RColorBrewer",
"RANN", "tm", "topicmodels","tidytext",
"wordCloud","RColorBrewer", "readxl")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE)
}
# load packages
library("rvest")
library("tibble")
# You may need to run
# sudo ln -f -s $(/usr/libexec/java_home)/jre/lib/server/libjvm.dylib /usr/local/lib
# in order to load qdap
library("qdap")
library("sentimentr")
library("gplots")
library("dplyr")
library("tm")
library("syuzhet")
library("factoextra")
library("beeswarm")
library("scales")
library("RColorBrewer")
library("RANN")
library("tm")
library("topicmodels")
library("tidytext")
library("wordcloud")
library("RColorBrewer")
library("readxl")
source("../lib/plotstacked.R")
source("../lib/speechFuncs.R")
source("../lib/speechesCLoud.R")
View(inaug.list)
print(R.version)
print(R.version)
print(R.version)
print(R.version)
R.version
### Inauguaral speeches
main.page <- read_html(x = "http://www.presidency.ucsb.edu/inaugurals.php")
# Get link URLs
# f.speechlinks is a function for extracting links from the list of speeches.
inaug=f.speechlinks(main.page)
head(inaug)
colnames(inaug) <- c("Date","Links")
# To avoid some problems when we transform the data format.
if(Sys.getlocale("LC_TIME") != "C"){
Sys.setlocale("LC_TIME","C")
}
inaug[,1] <-as.Date(inaug[,1], format="%B %e, %Y")
inaug=inaug[-nrow(inaug),] # remove the last line, irrelevant due to error.
# Import the information data of inauguration speeches.
inaug.list <- read_excel("../data/InaugurationInfo.xlsx")
inaug.list <- cbind(inaug.list,inaug)
# Read in full text
inaug.list$fulltext=NA
for(i in seq(nrow(inaug.list))) {
text <- read_html(inaug.list$Links[i]) %>% # load the page
html_nodes(".displaytext") %>% # isloate the text
html_text() # get the text
inaug.list$fulltext[i]=text
}
head(inaug.list)
sentence.list=NULL
for(i in 1:nrow(inaug.list)){
sentences=sent_detect(inaug.list$fulltext[i],
endmarks = c("?", ".", "!", "|",";"))
if(length(sentences)>0){
emotions=get_nrc_sentiment(sentences)
word.count=word_count(sentences)
# colnames(emotions)=paste0("emo.", colnames(emotions))
# in case the word counts are zeros?
emotions=diag(1/(word.count+0.01))%*%as.matrix(emotions)
sentence.list=rbind(sentence.list,
cbind(inaug.list[i,-ncol(inaug.list)],
sentences=as.character(sentences),
word.count,
emotions,
sent.id=1:length(sentences)
)
)
}
}
print(R.version)
sentence.list=NULL
for(i in 1:nrow(inaug.list)){
sentences=sent_detect(inaug.list$fulltext[i],
endmarks = c("?", ".", "!", "|",";"))
if(length(sentences)>0){
emotions=get_nrc_sentiment(sentences)
word.count=word_count(sentences)
# colnames(emotions)=paste0("emo.", colnames(emotions))
# in case the word counts are zeros?
emotions=diag(1/(word.count+0.01))%*%as.matrix(emotions)
sentence.list=rbind(sentence.list,
cbind(inaug.list[i,-ncol(inaug.list)],
sentences=as.character(sentences),
word.count,
emotions,
sent.id=1:length(sentences)
)
)
}
}
View(inaug.list)
sentence.list$Type = "inaug"
sentence.list=
sentence.list%>%
filter(!is.na(word.count))
### Inauguaral speeches
main.page <- read_html(x = "http://www.presidency.ucsb.edu/inaugurals.php")
# Get link URLs
# f.speechlinks is a function for extracting links from the list of speeches.
inaug=f.speechlinks(main.page)
head(inaug)
colnames(inaug) <- c("Date","Links")
# To avoid some problems when we transform the data format.
if(Sys.getlocale("LC_TIME") != "C"){
Sys.setlocale("LC_TIME","C")
}
inaug[,1] <-as.Date(inaug[,1], format="%B %e, %Y")
inaug=inaug[-nrow(inaug),] # remove the last line, irrelevant due to error.
# Import the information data of inauguration speeches.
inaug.list <- read_excel("../data/InaugurationInfo.xlsx")
inaug.list <- cbind(inaug.list,inaug)
# Read in full text
inaug.list$fulltext=NA
for(i in seq(nrow(inaug.list))) {
text <- read_html(inaug.list$Links[i]) %>% # load the page
html_nodes(".displaytext") %>% # isloate the text
html_text() # get the text
inaug.list$fulltext[i]=text
}
head(inaug.list)
View(inaug.list)
inaug.list[1,]
setwd("~/Documents/GitHub/Spring2018-Project1-htmy102")
save.image("~/Documents/GitHub/Spring2018-Project1-htmy102/dataset.RData")
